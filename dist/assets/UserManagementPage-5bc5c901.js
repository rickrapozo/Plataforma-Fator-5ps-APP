import{a as _,u as q,d as z,j as e}from"./index-9af3c308.js";import{r}from"./vendor-abc4fb99.js";import{a as H}from"./router-4d0cf74f.js";import{$ as J,g as S,a0 as X,a3 as K,J as O,V as Q,ae as W,a9 as Y,af as Z,m as ee,ag as se,j as te,i as ae,aa as le,a1 as U,w as re,ah as ie,o as ne}from"./ui-4d99af29.js";import"./pdf-eb8c75c2.js";const me=()=>{const k=H(),[u,f]=r.useState([]),[p,E]=r.useState(""),[o,P]=r.useState("all"),[g,L]=r.useState("all"),[i,x]=r.useState([]),[l,j]=r.useState(1),c=10,{getActiveUsers:T}=_({updateInterval:6e4}),{isLoading:b,isAuthorized:w,error:v,logAction:y}=q();r.useEffect(()=>{!b&&w&&(M(),y("user_management_access",{filter:o}))},[b,w,o,y]);const M=async()=>{try{const s=await z.getUsers();f(s)}catch(s){console.error("Erro ao carregar usuários:",s)}},h=u.filter(s=>{const t=s.name.toLowerCase().includes(p.toLowerCase())||s.email.toLowerCase().includes(p.toLowerCase()),a=o==="all"||s.role===o,n=g==="all"||s.status===g;return t&&a&&n}),m=Math.ceil(h.length/c),d=h.slice((l-1)*c,l*c),A=s=>{switch(s){case"active":return"text-success-green";case"inactive":return"text-pearl-white/60";case"suspended":return"text-error-red";case"pending":return"text-warning-yellow";default:return"text-pearl-white/60"}},R=s=>{switch(s){case"active":return ne;case"inactive":return U;case"suspended":return ie;case"pending":return re;default:return U}};if(b)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-deep-teal via-ocean-blue to-royal-purple flex items-center justify-center",children:e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx(J,{className:"w-16 h-16 text-royal-gold mx-auto mb-4 animate-spin"}),e.jsx("h1",{className:"text-white text-2xl font-bold mb-2",children:"Verificando Acesso"}),e.jsx("p",{className:"text-pearl-white/80",children:"Validando suas credenciais administrativas..."})]})});if(!w||v)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-deep-teal via-ocean-blue to-royal-purple flex items-center justify-center",children:e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx(S,{className:"w-16 h-16 text-error-red mx-auto mb-4"}),e.jsx("h1",{className:"text-white text-2xl font-bold mb-2",children:"Acesso Negado"}),e.jsx("p",{className:"text-pearl-white/80 mb-6",children:v||"Você não tem permissão para acessar o gerenciamento de usuários."}),e.jsx("button",{onClick:()=>k("/admin"),className:"bg-royal-gold hover:bg-bright-gold text-deep-teal px-6 py-2 rounded-lg font-semibold transition-colors",children:"Voltar ao Painel"})]})});const D=s=>{switch(s){case"superadmin":return"text-royal-purple";case"admin":return"text-royal-gold";case"user":return"text-bright-gold";default:return"text-pearl-white/60"}},$=s=>{switch(s){case"enterprise":return"text-royal-purple";case"premium":return"text-royal-gold";case"free":return"text-pearl-white/60";default:return"text-pearl-white/60"}},I=s=>new Date(s).toLocaleDateString("pt-BR"),V=s=>{const t=new Date(s),n=Math.floor((new Date().getTime()-t.getTime())/(1e3*60*60));if(n<1)return"Agora";if(n<24)return`${n}h atrás`;const C=Math.floor(n/24);return C<7?`${C}d atrás`:I(s)},B=s=>{x(t=>t.includes(s)?t.filter(a=>a!==s):[...t,s])},F=()=>{i.length===d.length?x([]):x(d.map(s=>s.id))},N=s=>{console.log(`Ação em lote: ${s} para usuários:`,i),x([])},G=s=>{confirm("Tem certeza que deseja excluir este usuário?")&&f(t=>t.filter(a=>a.id!==s))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-deep-navy via-royal-purple to-midnight-blue p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Gerenciamento de Usuários"}),e.jsx("p",{className:"text-pearl-white/80",children:"Gerencie usuários, permissões e assinaturas da plataforma"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(X,{className:"w-8 h-8 text-royal-gold"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:"Total Usuários"}),e.jsx("p",{className:"text-pearl-white/60 text-sm",children:"Registrados"})]})]}),e.jsx("p",{className:"text-3xl font-bold text-white",children:u.length}),e.jsx("p",{className:"text-success-green text-sm mt-2",children:"+12 esta semana"})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(K,{className:"w-8 h-8 text-bright-gold"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:"Usuários Ativos"}),e.jsx("p",{className:"text-pearl-white/60 text-sm",children:"Últimos 30 dias"})]})]}),e.jsx("p",{className:"text-3xl font-bold text-white",children:T(30*24*60)}),e.jsx("p",{className:"text-royal-gold text-sm mt-2",children:"Taxa: 78%"})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(S,{className:"w-8 h-8 text-success-green"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:"Administradores"}),e.jsx("p",{className:"text-pearl-white/60 text-sm",children:"Com acesso"})]})]}),e.jsx("p",{className:"text-3xl font-bold text-white",children:u.filter(s=>s.role==="admin"||s.role==="superadmin").length}),e.jsx("p",{className:"text-pearl-white/60 text-sm mt-2",children:"Ativos"})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(O,{className:"w-8 h-8 text-royal-purple"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:"Novos Hoje"}),e.jsx("p",{className:"text-pearl-white/60 text-sm",children:"Registros"})]})]}),e.jsx("p",{className:"text-3xl font-bold text-white",children:"8"}),e.jsx("p",{className:"text-success-green text-sm mt-2",children:"+25%"})]})]}),e.jsxs("div",{className:"glass-card p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-pearl-white/60 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Buscar usuários...",value:p,onChange:s=>E(s.target.value),className:"pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-pearl-white/60 focus:outline-none focus:border-royal-gold w-64"})]}),e.jsxs("select",{value:o,onChange:s=>P(s.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:border-royal-gold",children:[e.jsx("option",{value:"all",children:"Todas as funções"}),e.jsx("option",{value:"user",children:"Usuário"}),e.jsx("option",{value:"admin",children:"Administrador"}),e.jsx("option",{value:"superadmin",children:"Super Admin"})]}),e.jsxs("select",{value:g,onChange:s=>L(s.target.value),className:"px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:border-royal-gold",children:[e.jsx("option",{value:"all",children:"Todos os status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"suspended",children:"Suspenso"}),e.jsx("option",{value:"pending",children:"Pendente"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{className:"neuro-button bg-success-green hover:bg-success-green/80 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Novo Usuário"})]}),e.jsxs("button",{className:"neuro-button bg-royal-gold hover:bg-royal-gold/80 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{children:"Exportar"})]}),e.jsxs("button",{className:"neuro-button bg-bright-gold hover:bg-bright-gold/80 text-white px-4 py-2 rounded-lg transition-colors flex items-center space-x-2",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Importar"})]})]})]}),i.length>0&&e.jsx("div",{className:"mt-4 p-4 bg-royal-gold/20 border border-royal-gold/30 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-white",children:[i.length," usuário(s) selecionado(s)"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>N("activate"),className:"px-3 py-1 bg-success-green hover:bg-success-green/80 text-white rounded transition-colors text-sm",children:"Ativar"}),e.jsx("button",{onClick:()=>N("suspend"),className:"px-3 py-1 bg-warning-yellow hover:bg-warning-yellow/80 text-white rounded transition-colors text-sm",children:"Suspender"}),e.jsx("button",{onClick:()=>N("delete"),className:"px-3 py-1 bg-error-red hover:bg-error-red/80 text-white rounded transition-colors text-sm",children:"Excluir"})]})]})})]}),e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-white/5",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-left",children:e.jsx("input",{type:"checkbox",checked:i.length===d.length&&d.length>0,onChange:F,className:"rounded border-white/20 bg-white/10 text-royal-gold focus:ring-royal-gold"})}),e.jsx("th",{className:"p-4 text-left text-white font-semibold",children:"Usuário"}),e.jsx("th",{className:"p-4 text-left text-white font-semibold",children:"Função"}),e.jsx("th",{className:"p-4 text-left text-white font-semibold",children:"Status"}),e.jsx("th",{className:"p-4 text-left text-white font-semibold",children:"Assinatura"}),e.jsx("th",{className:"p-4 text-left text-white font-semibold",children:"Último Login"}),e.jsx("th",{className:"p-4 text-left text-white font-semibold",children:"Atividade"}),e.jsx("th",{className:"p-4 text-left text-white font-semibold",children:"Ações"})]})}),e.jsx("tbody",{children:d.map((s,t)=>{const a=R(s.status);return e.jsxs(ee.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.1},className:"border-t border-white/10 hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("input",{type:"checkbox",checked:i.includes(s.id),onChange:()=>B(s.id),className:"rounded border-white/20 bg-white/10 text-royal-gold focus:ring-royal-gold"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-royal-gold/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-royal-gold font-semibold",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsx("p",{className:"text-pearl-white/60 text-sm",children:s.email})]})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`font-medium ${D(s.role)}`,children:s.role==="superadmin"?"Super Admin":s.role==="admin"?"Administrador":"Usuário"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(a,{className:`w-4 h-4 ${A(s.status)}`}),e.jsx("span",{className:`font-medium ${A(s.status)}`,children:s.status==="active"?"Ativo":s.status==="inactive"?"Inativo":s.status==="suspended"?"Suspenso":"Pendente"})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`font-medium ${$(s.subscription)}`,children:s.subscription==="enterprise"?"Enterprise":s.subscription==="premium"?"Premium":"Gratuito"})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"text-pearl-white/80 text-sm",children:V(s.lastLogin)})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{className:"text-white",children:[s.totalSessions," sessões"]}),e.jsxs("p",{className:"text-pearl-white/60",children:[s.completedJourneys," jornadas"]})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>console.log("Edit user:",s.id),className:"p-2 text-royal-gold hover:bg-royal-gold/20 rounded-lg transition-colors",title:"Editar usuário",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-bright-gold hover:bg-bright-gold/20 rounded-lg transition-colors",title:"Ver detalhes",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 text-success-green hover:bg-success-green/20 rounded-lg transition-colors",title:"Enviar email",children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>G(s.id),className:"p-2 text-error-red hover:bg-error-red/20 rounded-lg transition-colors",title:"Excluir usuário",children:e.jsx(le,{className:"w-4 h-4"})})]})})]},s.id)})})]})}),m>1&&e.jsxs("div",{className:"p-4 border-t border-white/10 flex items-center justify-between",children:[e.jsxs("p",{className:"text-pearl-white/60 text-sm",children:["Mostrando ",(l-1)*c+1," a ",Math.min(l*c,h.length)," de ",h.length," usuários"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>j(s=>Math.max(s-1,1)),disabled:l===1,className:"px-3 py-1 bg-white/10 hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Anterior"}),Array.from({length:m},(s,t)=>t+1).map(s=>e.jsx("button",{onClick:()=>j(s),className:`px-3 py-1 rounded transition-colors ${l===s?"bg-royal-gold text-white":"bg-white/10 hover:bg-white/20 text-white"}`,children:s},s)),e.jsx("button",{onClick:()=>j(s=>Math.min(s+1,m)),disabled:l===m,className:"px-3 py-1 bg-white/10 hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors",children:"Próximo"})]})]})]})]})})};export{me as default};
