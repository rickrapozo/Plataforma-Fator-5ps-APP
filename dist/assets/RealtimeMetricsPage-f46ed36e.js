import{u as V,a as _,j as e}from"./index-9af3c308.js";import{r as j}from"./vendor-abc4fb99.js";import{a as D}from"./router-4d0cf74f.js";import{$ as v,g as F,m as o,a0 as K,j as Z,Z as q,w as f,a7 as B,a3 as W,q as X,a as G,a1 as J,o as O,ac as Q,ad as Y,K as ee}from"./ui-4d99af29.js";import"./pdf-eb8c75c2.js";const le=()=>{const A=D(),{isLoading:C,isAuthorized:d,error:T,logAction:w}=V(),[x,U]=j.useState("1h"),[l,R]=j.useState(!0),{metrics:t,analysisLoading:N,refreshMetrics:S,refreshAnalysis:M,getMetricsTrend:i,getTopPages:$,getActiveUsers:P,getErrorRate:m,getPerformanceScore:h,hasWarnings:g,isCritical:p,hasAnalysis:E}=_({updateInterval:l?3e4:0,enableAnalysis:!0,historicalHours:x==="1h"?1:x==="6h"?6:24});if(C)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-deep-navy via-royal-purple to-midnight-blue flex items-center justify-center",children:e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx(v,{className:"w-8 h-8 text-royal-gold animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-white",children:"Verificando permissões..."})]})});if(!d||T)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-deep-navy via-royal-purple to-midnight-blue flex items-center justify-center",children:e.jsxs("div",{className:"glass-card p-8 text-center max-w-md",children:[e.jsx(F,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Acesso Negado"}),e.jsx("p",{className:"text-pearl-white/80 mb-6",children:"Você não tem permissão para acessar as métricas em tempo real."}),e.jsx("button",{onClick:()=>A("/dashboard"),className:"px-6 py-2 bg-royal-gold hover:bg-royal-gold/80 text-white rounded-lg transition-colors",children:"Voltar ao Dashboard"})]})});const k=s=>s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}K`:s.toString(),c=s=>`${s.toFixed(1)}%`,L=s=>{switch(s){case"increasing":return e.jsx(ee,{className:"w-4 h-4 text-success-green"});case"decreasing":return e.jsx(Y,{className:"w-4 h-4 text-error-red"});default:return e.jsx(Q,{className:"w-4 h-4 text-pearl-white/60"})}},H=()=>p?"text-error-red":g?"text-warning-yellow":"text-success-green";j.useEffect(()=>{if(!d)return;(async()=>{try{await w("access_realtime_metrics",{page:"RealtimeMetricsPage"})}catch(a){console.error("Erro ao registrar acesso às métricas:",a)}})()},[d,w]);const I=()=>p?e.jsx(J,{className:"w-6 h-6"}):g?e.jsx(f,{className:"w-6 h-6"}):e.jsx(O,{className:"w-6 h-6"}),r=({title:s,value:a,icon:u,trend:y,subtitle:b,color:z="text-white"})=>e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card p-6 hover:bg-white/10 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-royal-gold/20 rounded-lg",children:u}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-pearl-white/80 text-sm font-medium",children:s}),b&&e.jsx("p",{className:"text-pearl-white/60 text-xs",children:b})]})]}),y&&L(y)]}),e.jsx("div",{className:`text-2xl font-bold ${z}`,children:a})]}),n=({title:s,children:a,actions:u})=>e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-white text-lg font-semibold",children:s}),u]}),a]});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-deep-navy via-royal-purple to-midnight-blue p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(o.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-white text-3xl font-bold mb-2",children:"Métricas em Tempo Real"}),e.jsx("p",{className:"text-pearl-white/80",children:"Monitoramento completo da plataforma com IA integrada"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:x,onChange:s=>U(s.target.value),className:"bg-white/10 text-white px-4 py-2 rounded-lg border border-white/20 focus:outline-none focus:border-royal-gold",children:[e.jsx("option",{value:"1h",children:"Última Hora"}),e.jsx("option",{value:"6h",children:"Últimas 6 Horas"}),e.jsx("option",{value:"24h",children:"Últimas 24 Horas"})]}),e.jsx("button",{onClick:()=>R(!l),className:`px-4 py-2 rounded-lg transition-colors ${l?"bg-success-green text-white":"bg-white/10 text-pearl-white/80 hover:bg-white/20"}`,children:e.jsx(v,{className:`w-4 h-4 ${l?"animate-spin":""}`})}),e.jsx("button",{onClick:S,className:"neuro-button bg-royal-gold hover:bg-royal-gold/80 text-white px-4 py-2 rounded-lg transition-colors",children:"Atualizar"})]})]}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card p-6 mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`${H()}`,children:I()}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-white text-xl font-semibold",children:["Status do Sistema: ",p?"Crítico":g?"Atenção":"Saudável"]}),e.jsxs("p",{className:"text-pearl-white/80",children:["Última atualização: ",t.lastUpdated?.toLocaleTimeString()||"Nunca"]})]})]}),t.health.issues.length>0&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-pearl-white/80 text-sm mb-1",children:"Problemas detectados:"}),e.jsx("ul",{className:"text-error-red text-sm space-y-1",children:t.health.issues.map((s,a)=>e.jsxs("li",{children:["• ",s]},a))})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(r,{title:"Usuários Ativos",value:P(30),icon:e.jsx(K,{className:"w-6 h-6 text-royal-gold"}),trend:i("activeUsers"),subtitle:"Últimos 30 minutos"}),e.jsx(r,{title:"Visualizações",value:k(t.current?.totalUsers||0),icon:e.jsx(Z,{className:"w-6 h-6 text-royal-gold"}),trend:i("totalUsers"),subtitle:"Total hoje"}),e.jsx(r,{title:"Performance",value:`${h()}%`,icon:e.jsx(q,{className:"w-6 h-6 text-royal-gold"}),color:h()>80?"text-success-green":h()>60?"text-warning-yellow":"text-error-red",subtitle:"Score geral"}),e.jsx(r,{title:"Taxa de Erro",value:c(m()),icon:e.jsx(f,{className:"w-6 h-6 text-royal-gold"}),color:m()<1?"text-success-green":m()<5?"text-warning-yellow":"text-error-red",subtitle:"Última hora"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx(r,{title:"CPU",value:c(t.current?.cpuUsage||0),icon:e.jsx(B,{className:"w-6 h-6 text-royal-gold"}),trend:i("cpuUsage"),color:t.current&&t.current.cpuUsage>80?"text-error-red":t.current&&t.current.cpuUsage>60?"text-warning-yellow":"text-success-green"}),e.jsx(r,{title:"Memória",value:c(t.current?.memoryUsage||0),icon:e.jsx(W,{className:"w-6 h-6 text-royal-gold"}),trend:i("memoryUsage"),color:t.current&&t.current.memoryUsage>85?"text-error-red":t.current&&t.current.memoryUsage>70?"text-warning-yellow":"text-success-green"}),e.jsx(r,{title:"Tempo de Resposta",value:`${t.current?.responseTime?.toFixed(0)||0}ms`,icon:e.jsx(X,{className:"w-6 h-6 text-royal-gold"}),trend:i("responseTime"),color:t.current&&t.current.responseTime>2e3?"text-error-red":t.current&&t.current.responseTime>1e3?"text-warning-yellow":"text-success-green"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsx(n,{title:"Páginas Mais Visitadas",children:e.jsx("div",{className:"space-y-3",children:$().slice(0,8).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-6 h-6 bg-royal-gold/20 rounded text-royal-gold text-xs flex items-center justify-center font-semibold",children:a+1}),e.jsx("span",{className:"text-white text-sm",children:s.page})]}),e.jsxs("span",{className:"text-pearl-white/80 text-sm",children:[s.views," views"]})]},s.page))})}),e.jsx(n,{title:"Atividades Recentes",children:e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:t.activities.slice(-10).reverse().map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-white/10 last:border-b-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm",children:s.action}),e.jsx("p",{className:"text-pearl-white/60 text-xs",children:s.page})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-pearl-white/80 text-xs",children:new Date(s.timestamp).toLocaleTimeString()}),e.jsxs("p",{className:"text-pearl-white/60 text-xs",children:[s.user_id.substring(0,8),"..."]})]})]},a))})})]}),E&&e.jsxs(n,{title:"Análise de IA",actions:e.jsxs("button",{onClick:M,disabled:N,className:"neuro-button bg-royal-gold hover:bg-royal-gold/80 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50 flex items-center space-x-2",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:N?"Analisando...":"Atualizar Análise"})]}),children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-3",children:"Insights"}),e.jsx("ul",{className:"space-y-2",children:t.analysis?.insights.map((s,a)=>e.jsxs("li",{className:"text-pearl-white/80 text-sm flex items-start space-x-2",children:[e.jsx("span",{className:"text-royal-gold mt-1",children:"•"}),e.jsx("span",{children:s})]},a))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold mb-3",children:"Recomendações"}),e.jsx("ul",{className:"space-y-2",children:t.analysis?.recommendations.map((s,a)=>e.jsxs("li",{className:"text-pearl-white/80 text-sm flex items-start space-x-2",children:[e.jsx("span",{className:"text-success-green mt-1",children:"→"}),e.jsx("span",{children:s})]},a))})]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-pearl-white/80",children:[e.jsx("strong",{children:"Resumo:"})," ",t.analysis?.summary]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-pearl-white/60 text-sm",children:"Confiança"}),e.jsx("p",{className:"text-royal-gold font-semibold",children:c((t.analysis?.confidence||0)*100)})]})]})})]}),t.errors.length>0&&e.jsx(n,{title:"Logs de Erro Recentes",children:e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:t.errors.slice(-10).reverse().map(s=>e.jsxs("div",{className:"p-3 bg-error-red/10 border border-error-red/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${s.severity==="critical"?"bg-error-red text-white":s.severity==="high"?"bg-warning-yellow text-black":s.severity==="medium"?"bg-royal-gold text-white":"bg-pearl-white/20 text-pearl-white"}`,children:s.severity.toUpperCase()}),e.jsx("span",{className:"text-pearl-white/60 text-xs",children:new Date(s.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-white text-sm font-medium mb-1",children:s.error_type}),e.jsx("p",{className:"text-pearl-white/80 text-sm",children:s.error_message}),e.jsxs("p",{className:"text-pearl-white/60 text-xs mt-1",children:["Página: ",s.page]})]},s.id))})})]})})};export{le as default};
